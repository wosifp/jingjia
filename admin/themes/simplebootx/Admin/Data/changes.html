<admintpl file="header" />
</head>

<link href="__PUBLIC__/admin/css/bootstrap.min.css" rel="stylesheet">
<link href="__PUBLIC__/admin/css/style.css" rel="stylesheet" type="text/css"/>
<script src="__PUBLIC__/admin/js/bootstrap.min.js" type="text/javascript"></script>
<script src="__PUBLIC__/admin/js/jquery.min.js"></script>
<script src="__PUBLIC__/admin/js/style.js" type="text/javascript"></script>
<script src="__PUBLIC__/js/datePicker/laydate/laydate.js"></script>


<body>
<div class="qi_right_1">
    <div class="qi_con_1">
        <div class="qi_float_l qi_bfb_30">
                <p class="qi_p_2">
                    账户：<a class="btn btn-default" href="javascript:" role="button">选择 <span class="caret"></span></a>
                </p>
                <div id="firstpane" class="menu_list" style="display:none">
                    <hr>
                    <p class="qi_p_3">
                        <span>可获取对象</span>
                        <input type="text">
                        <a href="javascript:" class="qi_a_1">搜索</a>
                        <!--<input id="r2" type="radio" value="1" name="">精确 </input>-->
                    </p>
                    <foreach name="trade" item="vo" key="k">
                        <h3 class="menu_head">{$k}</h3>
                        <div style="display: none;" class="menu_body">
                            <foreach name="vo" item="companyname" key="kk">
                                <a href="javascript:" >{$kk}</a>
                                <div style="display: none;" class="menu_body">
                                    <foreach name="companyname" item="user_login" key="kkk">
                                        <a href="javascript:"><span class="bai_name">{$user_login.user_login}</span></a>
                                    </foreach>
                                </div>
                            </foreach>
                        </div>
                    </foreach>
                </div>
            </div>


        <!--时间-->
        <div class="qi_float_l qi_bfb_40">
            时间：<input class="qi_inp_wid" id="datepicker1">
            <script>
                laydate.render({
  elem: '#datepicker1' ,
  range: true,//指定元素
  done: function(value){
        $.ajax({
            type: "post",
            url: "/Admin/Data/changes",
            data: {
                datepicker:value
            },
            dataType: "json",
            success: function(data){
                alert(1111111);
            }
        });
  } 
});
            </script>
        </div>
        <!--时间 end-->
    </div>


    <div class="qi_con_1">

        <ul class="pager qi_mag_bott">时间范围：
            <li><a href="javascript:">增长</a></li>
            <li><a href="javascript:">下降</a></li>
        </ul>

        <ul class="pager qi_mag_bott">筛选条件：
            <li><a href="javascript:">消费额</a></li>
            <li><a href="javascript:">消费变化率</a></li>
            <li><a href="javascript:">点击额</a></li>
            <li><a href="javascript:">点击变化率</a></li>
            <li><a href="javascript:">展现</a></li>
            <li><a href="javascript:">平均点击价格</a></li>
        </ul>

        <ul class="pager qi_mag_bott">层级筛选：
            <li><a href="javascript:">计划</a></li>
            <li><a href="javascript:">单元</a></li>
            <li><a href="javascript:">关键词</a></li>
        </ul>

        <ul class="pager qi_mag_bott">地域：
            <li><a href="javascript:">全部</a></li>
            <li><a href="javascript:">自定义</a></li>
        </ul>

        <!--柱状图-->

        <div height="400" width="600" style="margin:50px">
            <canvas id="barChart"> 你的浏览器不支持HTML5 canvas </canvas>
        </div>
        <script type="text/javascript">
            function goBarChart(dataArr){
                // 声明所需变量
                var canvas,ctx;
                // 图表属性
                var cWidth, cHeight, cMargin, cSpace;
                var originX, originY;
                // 柱状图属性
                var bMargin, tobalBars, bWidth, maxValue;
                var totalYNomber;
                var gradient;

                // 运动相关变量
                var ctr, numctr, speed;
                //鼠标移动
                var mousePosition = {};

                // 获得canvas上下文
                canvas = document.getElementById("barChart");
                if(canvas && canvas.getContext){
                    ctx = canvas.getContext("2d");
                }
                initChart(); // 图表初始化
                drawLineLabelMarkers(); // 绘制图表轴、标签和标记
                drawBarAnimate(); // 绘制柱状图的动画
                //检测鼠标移动
                var mouseTimer = null;
                canvas.addEventListener("mousemove",function(e){
                    e = e || window.event;
                    if( e.offsetX || e.offsetX==0 ){
                        mousePosition.x = e.offsetX;
                        mousePosition.y = e.offsetY;
                    }else if( e.layerX || e.layerX==0 ){
                        mousePosition.x = e.layerX;
                        mousePosition.y = e.layerY;
                    }

                    clearTimeout(mouseTimer);
                    mouseTimer = setTimeout(function(){
                        ctx.clearRect(0,0,canvas.width, canvas.height);
                        drawLineLabelMarkers();
                        drawBarAnimate(true);
                    },10);
                });

                //点击刷新图表
                canvas.onclick = function(){
                    initChart(); // 图表初始化
                    drawLineLabelMarkers(); // 绘制图表轴、标签和标记
                    drawBarAnimate(); // 绘制折线图的动画
                };


                // 图表初始化
                function initChart(){
                    // 图表信息
                    cMargin = 60;
                    cSpace = 80;
                    /*这里是对高清屏幕的处理，
                        方法：先将canvas的width 和height设置成本来的两倍
                        然后将style.height 和 style.width设置成本来的宽高
                        这样相当于把两倍的东西缩放到原来的 1/2，这样在高清屏幕上 一个像素的位置就可以有两个像素的值
                        这样需要注意的是所有的宽高间距，文字大小等都得设置成原来的两倍才可以。
                    */
                    canvas.width = canvas.parentNode.getAttribute("width")* 2 ;
                    canvas.height = canvas.parentNode.getAttribute("height")* 2;
                    canvas.style.height = canvas.height/2 + "px";
                    canvas.style.width = canvas.width/2 + "px";
                    cHeight = canvas.height - cMargin - cSpace;
                    cWidth = canvas.width - cMargin - cSpace;
                    originX = cMargin + cSpace;
                    originY = cMargin + cHeight;

                    // 柱状图信息
                    bMargin = canvas.width/40;
                    tobalBars = dataArr.length;
                    bWidth = parseInt( cWidth/tobalBars - bMargin );
                    maxValue = 0;
                    for(var i=0; i<dataArr.length; i++){
                        var barVal = parseInt( dataArr[i][1] );
                        if( barVal > maxValue ){
                            maxValue = barVal;
                        }
                    }
                    maxValue += 50;
                    totalYNomber = 10;
                    // 运动相关
                    ctr = 1;
                    numctr = 100;
                    speed = 10;

                    //柱状图渐变色
                    gradient = ctx.createLinearGradient(0, 0, 0, 300);
                    gradient.addColorStop(0, 'green');
                    gradient.addColorStop(1, 'rgba(67,203,36,1)');

                }

                // 绘制图表轴、标签和标记
                function drawLineLabelMarkers(){
                    //ctx.translate(0.5,0.5);  // 当只绘制1像素的线的时候，坐标点需要偏移，这样才能画出1像素实线
                    ctx.font = "24px Arial";
                    ctx.lineWidth = 2;
                    ctx.fillStyle = "#000";
                    ctx.strokeStyle = "#000";
                    // y轴
                    drawLine(originX, originY, originX, cMargin);
                    // x轴
                    drawLine(originX, originY, originX+cWidth, originY);

                    // 绘制标记
                    drawMarkers();
                    //ctx.translate(-0.5,-0.5);  // 还原位置
                }

                // 画线的方法
                function drawLine(x, y, X, Y){
                    ctx.beginPath();
                    ctx.moveTo(x, y);
                    ctx.lineTo(X, Y);
                    ctx.stroke();
                    ctx.closePath();
                }

                // 绘制标记
                function drawMarkers(){
                    ctx.strokeStyle = "#E0E0E0";
                    // 绘制 y
                    var oneVal = parseInt(maxValue/totalYNomber);
                    ctx.textAlign = "right";
                    for(var i=0; i<=totalYNomber; i++){
                        var markerVal =  i*oneVal;
                        var xMarker = originX-10;
                        var yMarker = parseInt( cHeight*(1-markerVal/maxValue) ) + cMargin;

                        ctx.fillText(markerVal, xMarker, yMarker+3, cSpace); // 文字
                        if(i>0){
                            drawLine(originX+2, yMarker, originX+cWidth, yMarker);
                        }
                    }
                    // 绘制 x
                    ctx.textAlign = "center";
                    for(var i=0; i<tobalBars; i++){
                        var markerVal = dataArr[i][0];
                        var xMarker = parseInt( originX+cWidth*(i/tobalBars)+bMargin+bWidth/2 );
                        var yMarker = originY+30;
                        ctx.fillText(markerVal, xMarker, yMarker, cSpace); // 文字
                    }
                    // 绘制标题 y
                    ctx.save();
                    ctx.rotate(-Math.PI/2);
                    ctx.fillText("值", -canvas.height/2, cSpace-10);
                    ctx.restore();
                    // 绘制标题 x
                    ctx.fillText("排行", originX+cWidth/2, originY+cSpace/2+30);
                };

                //绘制柱形图
                function drawBarAnimate(mouseMove){
                    for(var i=0; i<tobalBars; i++){
                        var oneVal = parseInt(maxValue/totalYNomber);
                        var barVal = dataArr[i][1];
                        var barH = parseInt( cHeight*barVal/maxValue * ctr/numctr );
                        var y = originY - barH;
                        var x = originX + (bWidth+bMargin)*i + bMargin;
                        drawRect( x, y, bWidth, barH-1, mouseMove );  //高度减一避免盖住x轴
                        ctx.fillText(parseInt(barVal*ctr/numctr), x+30, y-8); // 文字
                    }
                    if(ctr<numctr){
                        ctr++;
                        setTimeout(function(){
                            ctx.clearRect(0,0,canvas.width, canvas.height);
                            drawLineLabelMarkers();
                            drawBarAnimate();
                        }, speed);
                    }
                }

                //绘制方块
                function drawRect( x, y, X, Y, mouseMove ){

                    ctx.beginPath();
                    ctx.rect( x, y, X, Y );

                    if(mouseMove && ctx.isPointInPath(mousePosition.x*2, mousePosition.y*2)){ //如果是鼠标移动的到柱状图上，重新绘制图表
                        ctx.fillStyle = "green";

                    }else{
                        ctx.fillStyle = gradient;
                        ctx.strokeStyle = gradient;
                    }
                    ctx.fill();
                    ctx.closePath();

                }


            }


            goBarChart(
                [[01, 750], [02, 425], [03, 960], [04, 700], [05, 800], [06, 975], [07, 375], [08, 775], [09, 675], [10, 675]]
            )


        </script>

        <!--柱状图 end-->

        <div class="qi_con_1">
            <p class="qi_p_5">详细</p>
            <ul class="pager qi_float_r qi_mag_bott">
                <li><a href="javascript:">下载</a></li>
            </ul>
            <div class="table-responsive">
                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th>关键词</th>
                        <th>计划</th>
                        <th>单元</th>
                        <th>上期消费</th>
                        <th>本期消费</th>
                        <th>消费变化率</th>
                        <th>上期展现</th>
                        <th>本期</th>
                        <th>上期点击</th>
                        <th>本期点击</th>
                        <th>出价</th>
                        <th>匹配模式</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>list</td>
                        <td>list</td>
                        <td>sit</td>
                        <td>list</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>list</td>
                        <td>sit</td>
                        <td>sit</td>
                    </tr>
                    <tr>
                        <td>1,002</td>
                        <td>amet</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>consectetur</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>adipiscing</td>
                        <td>elit</td>
                    </tr>
                    <tr>
                        <td>list</td>
                        <td>list</td>
                        <td>sit</td>
                        <td>list</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>list</td>
                        <td>sit</td>
                        <td>sit</td>
                        <td>sit</td>
                    </tr>
                    </tbody>
                </table>
            </div>

        </div>



    </div>



</div>

</body>
</html>